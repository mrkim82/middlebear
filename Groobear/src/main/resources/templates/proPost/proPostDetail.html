<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/proPostTiles}">
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
<script
		th:src="@{https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js}"></script>
	<script
		th:src="@{https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js}"></script>
<style>
textarea {
  background-color: #f1f1f1;
  border: 1px solid #ddd;
  border-radius: 4px;
  padding: 10px;
  font-family: Arial, sans-serif;
  font-size: 14px;
  padding: 10px;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
  height: 200px;
  width: 100%;
  resize: vertical; /* 세로 조정 가능 */
}
p {
	margin: 0px;
}
.spanCursor {
	cursor: pointer
}

.gray {
	color: gray;
}

.grayC {
	color: gray;
	text-decoration:line-through;
}
[type="checkbox"] {
	margin-right: 15px;
}
</style>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

<!-- 차트 -->
<script type="text/javascript">
  google.charts.load("current", {packages:["corechart"]});
  google.charts.setOnLoadCallback(drawChart);
  //데이터 불러오기
function drawChart() {
    let url = window.location.pathname;
    let lastIndex = url.lastIndexOf('/');
    let projectNo = url.substring(lastIndex + 1);

    fetch("/googleChart", {
        method: 'POST',
        headers : {
            'Content-Type': 'application/json'
        },
        body : JSON.stringify(projectNo)
    })
    .then(response => response.json())
    .then(res => {
        var chartData = new google.visualization.DataTable();
        chartData.addColumn('string', 'workStatus');
        chartData.addColumn('number', 'count');
		//console.log(res);
        res.forEach(item => {
            // workStatus 값에 따라 이름을 변경
            let workStatusName = '';
            
            if (item.workStatus === '1') {
                workStatusName = '요청' + item.count + '%';
            } else if (item.workStatus === '2') {
                workStatusName = '진행' + item.count + '%';
            } else if (item.workStatus === '3') {
                workStatusName = '피드백' + item.count + '%';
            } else if (item.workStatus === '4') {
                workStatusName = '완료' + item.count + '%';
            } else if (item.workStatus === '5') {
                workStatusName = '보류' + item.count + '%';
            } 

            chartData.addRow([workStatusName, parseInt(item.count)]);
        });

        var options = {
            title: '업무 리포트',
            pieHole: 0.8,
            legend: {
                textStyle: {
                    fontSize: 14 // 폰트 크기를 12px로 설정
                },
                //position: 'bottom'//중앙정렬
            },
            series: {
                0: { color: '#2780e3' },
                1: { color: '#ff7518' },
                2: { color: '#ff0039' },
                3: { color: '#3fb618' },
                4: { color: '#373a3c' }
            },
            
        };

        var chart = new google.visualization.PieChart(document.getElementById('donutchart'));
        chart.draw(chartData, options);
    })
    .catch(error => {
        console.error('Error:', error);
    });
}
</script>	

</head>
<body layout:fragment="content" style="background-color: #fbfbfb">
	<!-- 중앙 + 참여자 -->
	<div>
		<!-- 중앙 -->
		<div style="overflow-y: auto; width: 680px; height: 676px;" class="float-start">
			<!-- 업무리포트(총 업무수)(차트) -->
			<div id="donutchart" style="width: 643px; height: 178px;"></div>
			<!-- 글 생성 nav -->
			<div>
				<ul class="nav justify-content-center"
					style="background-color: #faf9f9; margin: 10px;color: silver;">
					<li class="nav-item" data-post-code="1"><a class="nav-link"
						data-toggle="modal" data-target="#modal1" href="#"><span>글</span></a></li>
					<li class="nav-item" data-post-code="2"><a class="nav-link"
						data-toggle="modal" data-target="#modal2" href="#"><span>업무</span></a></li>
					<li class="nav-item" data-post-code="3"><a class="nav-link"
						data-toggle="modal" data-target="#modal3" href="#"><span>일정</span></a></li>
					<li class="nav-item" data-post-code="4"><a class="nav-link"
						data-toggle="modal" data-target="#modal4" href="#"><span>할
								일</span></a></li>
					<li class="nav-item" data-post-code="5"><a class="nav-link"
						data-toggle="modal" data-target="#modal5" href="#"><span>투표</span></a></li>
				</ul>

				<!-- 글 작성 모달 공간 -->
				<div>
				<div class="container">

					<!-- 1. 글 작성-->
					<div class="modal fade modal-dialog-scrollable" id="modal1" tabindex="-1" role="dialog"
						aria-labelledby="modal1Label" aria-hidden="true" style="display:none">
						<div class="modal-dialog" role="document">
							<div class="modal-content">
								<div class="modal-header">
									<h5 class="modal-title" id="modal1Label">글</h5>
									<button type="button" class="close" data-dismiss="modal"
										aria-label="Close">
										<span aria-hidden="true">&times;</span>
									</button>
								</div>
								<!-- 태그 선택 -->
								<div>
									<ul class="nav justify-content-center">
										<li class="nav-item" data-post-code="1"><a class="nav-link"
											href="#"><span>글</span></a></li>
										<li class="nav-item" data-post-code="2"><a class="nav-link"
											data-toggle="modal" data-target="#modal2" data-dismiss="modal" href="#"><span>업무</span></a></li>
										<li class="nav-item" data-post-code="3"><a class="nav-link"
											data-toggle="modal" data-target="#modal3" data-dismiss="modal" href="#"><span>일정</span></a></li>
										<li class="nav-item" data-post-code="4"><a class="nav-link"
											data-toggle="modal" data-target="#modal4" data-dismiss="modal" href="#"><span>할일</span></a></li>
										<li class="nav-item" data-post-code="5"><a class="nav-link"
											data-toggle="modal" data-target="#modal5" data-dismiss="modal" href="#"><span>투표</span></a></li>
									</ul>
								</div>
								<div class="modal-body">
									<div>
										<input type="text" placeholder="제목을 입력하세요." class="postTitle">
									</div>
									<div>
										<textarea placeholder="내용을 입력하세요." id="writingContent"></textarea>
									</div>
								</div>
								<button type="button" class="btn btn-primary" id="createWritingButton">등록</button>
							</div>
						</div>
					</div>
					
					<!-- 2.업무 작성 -->
					<div class="modal fade modal-dialog-scrollable" id="modal2" tabindex="-1" role="dialog"
						aria-labelledby="modal2Label" aria-hidden="true" style="display:none">
						<div class="modal-dialog" role="document">
							<div class="modal-content">
								<div class="modal-header">
									<h5 class="modal-title" id="modal2Label">업무</h5>
									<button type="button" class="close" data-dismiss="modal"
										aria-label="Close">
										<span aria-hidden="true">&times;</span>
									</button>
								</div>
								<!-- 태그 선택 -->
								<div>
									<ul class="nav justify-content-center">
										<li class="nav-item" data-post-code="1"><a class="nav-link"
											data-toggle="modal" data-target="#modal1" data-dismiss="modal" href="#"><span>글</span></a></li>
										<li class="nav-item" data-post-code="2"><a class="nav-link"
											href="#"><span>업무</span></a></li>
										<li class="nav-item" data-post-code="3"><a class="nav-link"
											data-toggle="modal" data-target="#modal3" data-dismiss="modal" href="#"><span>일정</span></a></li>
										<li class="nav-item" data-post-code="4"><a class="nav-link"
											data-toggle="modal" data-target="#modal4" data-dismiss="modal" href="#"><span>할일</span></a></li>
										<li class="nav-item" data-post-code="5"><a class="nav-link"
											data-toggle="modal" data-target="#modal5" data-dismiss="modal" href="#"><span>투표</span></a></li>
									</ul>
								</div>
								<div class="modal-body">
									<div>
										<input type="text" placeholder="제목을 입력하세요." class="postTitle">
									</div>
									<!-- 업무상태 -->
									<div id="workPostStatus">
										<button type="button" class="btn btn-primary" id="workTypeButtonToggle"
												data-work-type-status="1" onclick="toggleButtonStyle(this)">요청</button>
										<button type="button" class="btn btn-outline-warning"
												data-work-type-status="2" onclick="toggleButtonStyle(this)">진행</button>
										<button type="button" class="btn btn-outline-danger"
												data-work-type-status="3" onclick="toggleButtonStyle(this)">피드백</button>
										<button type="button" class="btn btn-outline-success"
												data-work-type-status="4" onclick="toggleButtonStyle(this)">완료</button>
										<button type="button" class="btn btn-outline-secondary"
												data-work-type-status="5" onclick="toggleButtonStyle(this)">보류</button>
									</div>
									<!-- 담당자 추가 -->
									<div>
										<p>담당자 추가(Ctrl을 누르면 중복 처리 가능)</p>
										<select class="form-select" multiple name="workMember" size=5 id="workPostPerson"
												onchange="workPostPeople(this)">
											<th:block th:each="member : ${projectPartiMember}">
													<!-- <option th:text="${member.name}" th:value="${member.id}"
													th:if="${member.id == session.Id}" style="background-color: #eee;"></option> -->
													<option th:text="${member.name} +'(나)'" th:value="${member.id}"
													th:if="${member.id == session.Id}"></option>
													<option th:text="${member.name}" th:value="${member.id}"
													th:if="${member.id != session.Id}"></option>
											</th:block>
										</select>
									</div>
									<!-- 항목 추가입력 -->
									<div>
										<p>
										  <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapseExample"
										  			aria-expanded="false" aria-controls="collapseExample">
										    + 항목추가입력
										  </button>
										</p>
										<div class="collapse" id="collapseExample">
										  <div class="card card-body">
										  	<!-- 시작일 추가 -->
										  	<div>
										  		<p>시작일</p>
													<input type="datetime-local" id="startWorkDate">
										  	</div>
										  	<!-- 마감일 추가 -->
										  	<div>
										  		<p>마감일</p>
										  		<input type="datetime-local"  id="endWorkDate">
										  	</div>
										  	<!-- 우선순위 추가 -->
										  	<div>
													<p>우선순위</p>
													<select class="custom-select" name="workPri" id="workPostPri">
														<option value="">없음</option>
														<option value="1">낮음</option>
														<option value="2">보통</option>
														<option value="3">높음</option>
														<option value="4">긴급</option>
													</select>
										  	</div>
										  	<!-- 그룹 추가 -->
										  	<div>
										  	
										  	<p>업무 그룹</p>
											<select class="form-select" name="workGroup" id="workPostGroup">
												<th:block th:each="group : ${readWorkGroup}">
														<option th:text="${group.workGroupName}" th:value="${group.workGroupNo}" th:selected="${group.workGroupSeq == 1}"></option>
												</th:block>
											</select>
										  	</div>
										  </div>
										</div>
									</div>
									
									<!-- 내용입력 -->
									<div>
										<textarea placeholder="내용을 입력하세요." id="workWritingContent"></textarea>
									</div>

									<!-- 하위업무 -->
									<div>
										<!-- 하위업무 수 -->
										<div>
											<p>ㄴ하위업무</p>
										</div>
										<!-- 하위업무 동적 생성 -->
										<div>
											<button type="button">+ 하위업무 추가</button>
										</div>
										<!-- 하위업무 입력란 -->
										<div>
											
										</div>
									</div>
								</div>
									<button type="button" class="btn btn-primary" id="createWorkButton">등록</button>
							</div>
						</div>
					</div>
					
					<!-- 3.일정 작성 -->
					<div class="modal fade modal-dialog-scrollable" id="modal3" tabindex="-1" role="dialog"
						aria-labelledby="modal3Label" aria-hidden="true" style="display:none">
						<div class="modal-dialog" role="document">
							<div class="modal-content">
								<div class="modal-header">
									<h5 class="modal-title" id="modal3Label">일정</h5>
									<button type="button" class="close" data-dismiss="modal"
										aria-label="Close">
										<span aria-hidden="true">&times;</span>
									</button>
								</div>
								<!-- 태그 선택 -->
								<div>
									<ul class="nav justify-content-center">
										<li class="nav-item" data-post-code="1"><a class="nav-link"
											data-toggle="modal" data-target="#modal1" data-dismiss="modal" href="#"><span>글</span></a></li>
										<li class="nav-item" data-post-code="2"><a class="nav-link"
											data-toggle="modal" data-target="#modal2" data-dismiss="modal" href="#"><span>업무</span></a></li>
										<li class="nav-item" data-post-code="3"><a class="nav-link"
											href="#"><span>일정</span></a></li>
										<li class="nav-item" data-post-code="4"><a class="nav-link"
											data-toggle="modal" data-target="#modal4" data-dismiss="modal" href="#"><span>할일</span></a></li>
										<li class="nav-item" data-post-code="5"><a class="nav-link"
											data-toggle="modal" data-target="#modal5" data-dismiss="modal" href="#"><span>투표</span></a></li>
									</ul>
								</div>
								<div class="modal-body">
									<div>
										<input type="text" placeholder="제목을 입력하세요." class="postTitle">
									</div>
									<!-- 시작일 -->
									<div>
										<p>시작일</p>
										<input type="datetime-local" id="startSchDate">
									</div>
									
									<!-- 마감일 -->
									<div>
										<p>마감일</p>
										<input type="datetime-local" id="endSchDate">
									</div>
									<!-- 참석자 -->
									<div>
										<p>참석자 추가(Ctrl을 누르면 중복 처리 가능)</p>
										<select class="form-select" multiple name="workMember" size=5>
											<th:block th:each="member : ${projectPartiMember}">
													<!-- <option th:text="${member.name}" th:value="${member.id}"
													th:if="${member.id == session.Id}" style="background-color: #eee;"></option> -->
													<option th:text="${member.name}" th:value="${member.id}"
													th:if="${member.id == session.Id}"></option>
													<option th:text="${member.name}" th:value="${member.id}"
													th:if="${member.id != session.Id}"></option>
											</th:block>
										</select>
									</div>
									<!-- 장소 -->
									<div>
										<input type="text">
									</div>
									<!-- 내용 -->
									<div>
										<textarea placeholder="내용을 입력하세요."></textarea>
									</div>
								</div>
									<button type="button" class="btn btn-primary">등록</button>
							</div>
						</div>
					</div>

					<!-- 4.할 일 작성 -->
					<div class="modal fade modal-dialog-scrollable" id="modal4" tabindex="-1" role="dialog"
						aria-labelledby="modal4Label" aria-hidden="true" style="display:none">
						<div class="modal-dialog" role="document">
							<div class="modal-content">
								<div class="modal-header">
									<h5 class="modal-title" id="modal4Label">할 일</h5>
									<button type="button" class="close" data-dismiss="modal"
										aria-label="Close">
										<span aria-hidden="true">&times;</span>
									</button>
								</div>
								<!-- 태그 선택 -->
								<div>
									<ul class="nav justify-content-center">
										<li class="nav-item" data-post-code="1"><a class="nav-link"
											data-toggle="modal" data-target="#modal1" data-dismiss="modal" href="#"><span>글</span></a></li>
										<li class="nav-item" data-post-code="2"><a class="nav-link"
											data-toggle="modal" data-target="#modal2" data-dismiss="modal" href="#"><span>업무</span></a></li>
										<li class="nav-item" data-post-code="3"><a class="nav-link"
											data-toggle="modal" data-target="#modal3" data-dismiss="modal" href="#"><span>일정</span></a></li>
										<li class="nav-item" data-post-code="4"><a class="nav-link"
											href="#"><span>할일</span></a></li>
										<li class="nav-item" data-post-code="5"><a class="nav-link"
											data-toggle="modal" data-target="#modal5" data-dismiss="modal" href="#"><span>투표</span></a></li>
									</ul>
								</div>
								<div class="modal-body">
									<div>
										<input type="text" placeholder="제목을 입력하세요." class="postTitle">
									</div>
									<!-- 할 일 입력 -->
									<div>
										<input type="text" placeholder="할 일 추가">
										<div>
											<input type="datetime-local">
											<select class="form-select" name="todoMember">
												<th:block th:each="member : ${projectPartiMember}">
													<option value="">없음</option>
													<option th:text="${member.name}" th:value="${member.id}"
													th:if="${member.id == session.Id}" style="background-color: #eee;"></option>
													<option th:text="${member.name}" th:value="${member.id}"
													th:if="${member.id != session.Id}"></option>
												</th:block>
											</select>
										</div>
									</div>
									<!-- 할 일 추가 -->
									<div>
									</div>
								</div>
								<button type="button" class="btn btn-primary">등록</button>
							</div>
						</div>
					</div>

					<!-- 투표 -->
					<div class="modal fade modal-dialog-scrollable" id="modal5" tabindex="-1" role="dialog"
						aria-labelledby="modal5Label" aria-hidden="true" style="display:none">
						<div class="modal-dialog" role="document">
							<div class="modal-content">
								<div class="modal-header">
									<h5 class="modal-title" id="modal5Label">투표</h5>
									<button type="button" class="close" data-dismiss="modal"
										aria-label="Close">
										<span aria-hidden="true">&times;</span>
									</button>
								</div>
								<!-- 태그 선택 -->
								<div>
									<ul class="nav justify-content-center">
										<li class="nav-item" data-post-code="1"><a class="nav-link"
											data-toggle="modal" data-target="#modal1" data-dismiss="modal" href="#"><span>글</span></a></li>
										<li class="nav-item" data-post-code="2"><a class="nav-link"
											data-toggle="modal" data-target="#modal2" data-dismiss="modal" href="#"><span>업무</span></a></li>
										<li class="nav-item" data-post-code="3"><a class="nav-link"
											data-toggle="modal" data-target="#modal3" data-dismiss="modal" href="#"><span>일정</span></a></li>
										<li class="nav-item" data-post-code="4"><a class="nav-link"
											data-toggle="modal" data-target="#modal4" data-dismiss="modal" href="#"><span>할일</span></a></li>
										<li class="nav-item" data-post-code="5"><a class="nav-link"
											href="#"><span>투표</span></a></li>
									</ul>
								</div>
								<div class="modal-body">
									<div>
										<input type="text" placeholder="제목을 입력하세요." class="postTitle">
									</div>
									<!-- 투표 설명 -->
									<div>
										<input type="text" placeholder="투표에 관한 설명 입력(옵션)">
									</div>
									<!-- 투표내용 -->
									<div>
										<input type="text" placeholder="항목 추가">
										<input type="text" placeholder="항목 추가">

									</div>
									<!-- 투표 항목 추가 -->
									<div>

									</div>
									<!-- 투표 마감일 -->
									<div>
										<p>투표 마감일</p>
										<input type="datetime-local" id="endVoteDate">
									</div>
									<!--  -->
								</div>
								<button type="button" class="btn btn-primary">등록</button>
							</div>
						</div>
					</div>
				</div>

				</div>
				<!-- 글 작성 모달 종료 -->

			</div>

			<!-- 미확인 알림(후순위) -->
			<div>
			
			</div>
			<!-- 상단고정(후순위) 업무 이후 -->
			<div>
			
			</div>
			
			<!-- 게시물 공간 -->
			<div>
				<div>
					<select name="postTypeFilter" id="postTypeFilter">
						<option value="">전체</option>
						<option value="1">업무</option>
						<option value="2">글</option>
							<option value="3">일정</option>
							<option value="4">할 일</option>
							<option value="5">투표</option>
					</select>
				</div>
				<div class="container">
					<th:block th:each="allPost : ${readFeedPost}">
						<!-- 1.업무 -->
						<th:block th:if="${allPost.postType == '1'}">
							<div class="card" style="margin-bottom: 15px; background-color: #fff"
								 th:attr="data-feed-post-no=${allPost.proPostNo}, data-feed-work-no=${allPost.workNo}">
								 <!-- th:classappend="${allPost.workStatus == '4' ? 'grayC' : ''}"> -->
								<!-- 프로필 이미지, 이름, 작성 날짜 및 시간, 상단고정 표시, 수정, 삭제 -->
								<div>
							        <span th:text="${allPost.profileImg}"></span>
							        <span th:text="${allPost.name}"></span>
							        <span th:text="${allPost.postDate}"></span>
							        <span th:text="업무번호 + ${allPost.workNo}"></span>
							    </div>
								<div class="card-header" th:text="'업무 : ' + ${allPost.postTitle}">
									<!-- 글 제목 -->
								</div>
								<div class="workFeedPostStatus" th:attr="data-feed-work-type=${allPost.workStatus}" style="text-align: center;">
								    <button type="button" class="btn"
								    		th:classappend="${allPost.workStatus == '1' ? 'btn-primary' : 'btn-outline-primary'}"
								            data-work-type-status="1" onclick="toggleFeedButtonStyle(this)">요청</button>
								    <button type="button" class="btn"
								    		th:classappend="${allPost.workStatus == '2' ? 'btn-warning' : 'btn-outline-warning'}"
								            data-work-type-status="2" onclick="toggleFeedButtonStyle(this)">진행</button>
								    <button type="button" class="btn"
								    		th:classappend="${allPost.workStatus == '3' ? 'btn-danger' : 'btn-outline-danger'}"
								            data-work-type-status="3" onclick="toggleFeedButtonStyle(this)">피드백</button>
								    <button type="button" class="btn"
								    		th:classappend="${allPost.workStatus == '4' ? 'btn-success' : 'btn-outline-success'}"
								            data-work-type-status="4" onclick="toggleFeedButtonStyle(this)">완료</button>
								    <button type="button" class="btn"
								    		th:classappend="${allPost.workStatus == '5' ? 'btn-secondary' : 'btn-outline-secondary'}"
								            data-work-type-status="5" onclick="toggleFeedButtonStyle(this)">보류</button>
								</div>
								<div class="card-body">
									<!-- 추가 항목 -->
									<div>
										<p>
										  <button class="btn btn-primary" type="button" data-toggle="collapse" th:data-target="'#collapseExample' + ${allPost.workNo}"
										  			aria-expanded="false" aria-controls="collapseExample">
										    + 항목추가입력
										  </button>
										</p>
										<!-- 하위업무 생성 공간 -->
										<div>

										</div>
										<div class="collapse" th:id="'collapseExample' + ${allPost.workNo}">
										  <div class="card card-body">
										  	<!-- 시작일 추가 -->
										  	<div>
										  		<p>시작일</p>
													<input type="datetime-local" id="startWorkDate2" th:value="${#dates.format(allPost.workStartDay, 'yyyy-MM-dd HH:mm')}">
										  	</div>
										  	<!-- 마감일 추가 -->
										  	<div>
										  		<p>마감일</p>
										  		<input type="datetime-local"  id="endWorkDate2" th:min="${#dates.format(#calendars.createNow())}" th:value="${#dates.format(allPost.workStartTime, 'yyyy-MM-dd HH:mm')}">
										  	</div>
										  	<!-- 우선순위 추가 -->
										  	<div>
													<p>우선순위</p>
													<select class="custom-select" name="workPri" id="workPostPri">
														<option value="">없음</option>
														<option value="1" th:selected="${allPost.workStatus == '1'}">낮음</option>
														<option value="2" th:selected="${allPost.workStatus == '2'}">보통</option>
													    <option value="3" th:selected="${allPost.workStatus == '3'}">높음</option>
													    <option value="4" th:selected="${allPost.workStatus == '4'}">긴급</option>
													</select>
										  	</div>
										  	<!-- 그룹 추가 -->
										  	<div>
										  	
										  	<p>업무 그룹</p>
											<select class="form-select" name="workGroup" id="workPostGroup2">
												<th:block th:each="group : ${readWorkGroup}">
														<option th:text="${group.workGroupName}" th:value="${group.workGroupNo}"
																th:selected="${allPost.workGroupNo == group.workGroupNo}"></option>
												</th:block>
											</select>
										  	</div>
										  </div>
										</div>
									</div>
									<!-- 항목추가 종료 -->
									<p th:text="${allPost.workContent}">
										<!-- 게시글 내용이 여기에 들어갑니다. -->
									</p>
									<div class="collapse" id="moreContent">
										<p>
											<!-- 추가적인 일정 내용이 여기에 들어갑니다. -->
										</p>
										<a class="btn btn-link" data-toggle="collapse" href="#moreContent" role="button"
											aria-expanded="false" aria-controls="moreContent">더보기</a>
									</div>
									<div class="card-footer">
										<!-- 하위업무 -->
										<div>
											<!-- 하위업무 수 -->
											<div>
												<p>ㄴ하위업무</p>
											</div>
											<!-- 하위업무 동적 생성 -->
											<div>
												<button type="button">+ 하위업무 추가</button>
											</div>
											<!-- 하위업무 입력란 -->
											<div>
												
											</div>
										</div>
										<!-- 북마크, 댓글수 -->
										<div>
										
										</div>
										<div class="row">
											<div class="col-md-8">
												<!--/* <h6 th:text="'댓글('+${#lists.size(projectWritingDetaisComment)}+')'"></h6> */-->
												<h6 th:text="댓글"></h6>
												<ul class="list-unstyled">
													<li th:each="com : ${projectWritingDetaisComment}" th:data-post-code="${com.comNo}"
														th:if="${allPost.proPostNo == com.proPostNo}">
														<span th:utext="${com.profileImg}"></span>
														<span th:text="${com.name}"></span>
														<span th:text="${com.comDate}"></span>
														<span th:text="${com.comContent}"></span>
														<th:block th:if="${com.id == session.Id}">
															<span onclick="UpdateWritingComment()" class="spanCursor" style="color: red">수정</span>
															<span></span>
															<span onclick="deleteWritingComment()" class="spanCursor">X</span>
														</th:block>
													</li>
												</ul>
											</div>
											<div class="col-md-4">
												<div class="form-group">
													<input type="text" class="form-control" placeholder="댓글 작성">
												</div>
												<button type="button" class="btn btn-primary" onclick="createCommentButton()"
														th:data-post-writing-no="${allPost.proPostNo}">댓글 등록</button>
											</div>
										</div>
									</div>
								</div>
							</div>
						</th:block>
						
						<!-- 2.글 -->
						<th:block th:if="${allPost.postType == '2'}">
							<div class="card" style="margin-bottom: 15px; background-color: #fff;">
								<!-- 프로필 이미지, 이름, 작성 날짜 및 시간, 상단고정 표시, 수정, 삭제 -->
								<div>
							        <span th:text="${allPost.profileImg}"></span>
							        <span th:text="${allPost.name}"></span>
							        <span th:text="${allPost.postDate}"></span>
							    </div>
								<div class="card-header" th:text="'글 : ' + ${allPost.postTitle}">
									<!-- 글 제목 -->
								</div>
								<div class="card-body">
									<p th:text="${allPost.writingContent}">
										<!-- 게시글 내용이 여기에 들어갑니다. -->
									</p>
									<div class="collapse" id="moreContent">
										<p>
											<!-- 추가적인 일정 내용이 여기에 들어갑니다. -->
										</p>
										<a class="btn btn-link" data-toggle="collapse" href="#moreContent" role="button"
											aria-expanded="false" aria-controls="moreContent">더보기</a>
									</div>
									<div class="card-footer">
										<!-- 북마크, 댓글수 -->
										<div>
										
										</div>
										<div class="row">
											<div class="col-md-8">
												<!--/* <h6 th:text="'댓글('+${#lists.size(projectWritingDetaisComment)}+')'"></h6> */-->
												<h6 th:text="댓글"></h6>
												<ul class="list-unstyled">
													<li th:each="com : ${projectWritingDetaisComment}" th:data-post-code="${com.comNo}"
														th:if="${allPost.proPostNo == com.proPostNo}">
														<span th:utext="${com.profileImg}"></span>
														<span th:text="${com.name}"></span>
														<span th:text="${com.comDate}"></span>
														<span th:text="${com.comContent}"></span>
														<th:block th:if="${com.id == session.Id}">
															<span onclick="UpdateWritingComment()" class="spanCursor" style="color: red">수정</span>
															<span></span>
															<span onclick="deleteWritingComment()" class="spanCursor">X</span>
														</th:block>
													</li>
												</ul>
											</div>
											<div class="col-md-4">
												<div class="form-group">
													<input type="text" class="form-control" placeholder="댓글 작성">
												</div>
												<button type="button" class="btn btn-primary" onclick="createCommentButton()"
														th:data-post-writing-no="${allPost.proPostNo}">댓글 등록</button>
											</div>
										</div>
									</div>
								</div>
							</div>
							<!-- 2종료 -->
						</th:block>
			
				<!-- 3.일정 -->
				<th:block th:if="${allPost.postType == '3'}">
					<div class="card" style="margin-bottom: 15px; background-color: #fff;"
						 th:attr="data-feed-post-sch-no=${allPost.proPostNo}, data-feed-sch-no=${allPost.schNo}">
						<!-- 프로필 이미지, 이름, 작성 날짜 및 시간, 상단고정 표시, 수정, 삭제 -->
						<div>
									<span th:text="${allPost.profileImg}"></span>
									<span th:text="${allPost.name}"></span>
									<span th:text="${allPost.postDate}"></span>
							</div>
						<div class="card-header" th:text="'일정 : ' + ${allPost.postTitle}">
							<!-- 글 제목 -->
						</div>
						<th:block th:text="'시작' + ${allPost.schStartTime}"></th:block>
						<th:block th:text="'종료' + ${allPost.schEndTime}"></th:block>
						<div class="card-body">
							<!-- 참석자 존 -->
							<div>
								<th:block th:each="rpl : ${readPartiZone}" th:if="${rpl.schNo == allPost.schNo}">
									<div th:text="${rpl.name}" th:data-sch-user-id="${rpl.id == session.Id ? rpl.id : ''}"
									 	 th:data-sch-list-id="${rpl.id}"></div>
									<th:block th:switch="${rpl.partiCheck}">
										<nav class="nav">
											<span th:case="Y" style="color: green;">참석</span>
											<span th:case="N" style="color: red;">불참</span>
											<span th:case="A" style="color: gray;">미정</span>
										</nav>
									</th:block>
								</th:block>
							</div>
							
								<!-- 참석자 리스트 버튼 -->
								<div>
									<button type="button" class="btn btn-light" data-toggle="modal" th:data-target="'#schPartiListModal' + ${allPost.proPostNo}"
											th:if="${#dates.format(allPost.schEndTime) >= #dates.format(#calendars.createNow())}">
													참석자 변경
									</button>
									<!-- 참석자 리스트 Modal -->
									<form>
										<div class="modal fade" th:id="'schPartiListModal' + ${allPost.proPostNo}" tabindex="-1"
												aria-labelledby="exampleModalLabel" aria-hidden="true">
											<div class="modal-dialog modal-dialog-centered">
												<div class="modal-content">
													<div class="modal-header">
														<h1 class="modal-title fs-5" id="exampleModalLabel">참석자 변경</h1>
														<button type="button" class="btn-close" data-dismiss="modal" aria-label="Close"></button>
													</div>
													<!-- 내용 -->
													<div class="modal-body">
														<ul>
															<li style="border-bottom: 1px solid gray; list-style-type: none;">
																<div>
																	<input type="checkbox" value="selectAll2" id="selectAll"
																		onclick='' /><label for="selectAll" style="cursor: pointer;">전체선택</label>
																		<input type="text" placeholder="참석자명 검색">
																</div>
															</li>
															<!-- 참가자 목록 -->
															<th:block th:each="member : ${projectPartiMember}">
																<li style="list-style-type: none">
																	<nav class="nav">
																			
																			<th:block th:each="rpl : ${readPartiList}" th:if="${rpl.schNo == allPost.schNo && rpl.id == member.id && rpl.partiCheck != null}">
																				<input type="checkbox" th:id="'schPartiList' + ${member.id} + ${rpl.schNo}"
																					th:checked="${rpl.id == member.id}"
																					th:data-sch-status="${rpl.partiCheck}"
																					th:data-sch-list-parti-id="${member.id}" th:data-sch-list-id="${member.id}">
																			</th:block>
																			<th:block th:each="rpl : ${readPartiList}" th:if="${rpl.schNo == allPost.schNo && rpl.id == member.id && rpl.partiCheck == null}">
																				<input type="checkbox" th:id="'schPartiList' + ${member.id} + ${rpl.schNo}"
																					th:data-sch-status="${rpl.partiCheck}"
																					th:data-sch-list-parti-id="${member.id}" th:data-sch-list-id="${member.id}">
																			</th:block>
																			
																			<label th:for="'schPartiList' + ${member.id}">
																				<a class="nav-link" th:utext="${member.profileImg}"></a>
																				<a class="nav-link" th:text="${member.name}"></a>
																			</label>
																	</nav>
																</li>
															</th:block>
														</ul>
													</div>
													<div class="modal-body">
														진짜?
													</div>
													<div class="modal-footer">
														<button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
														<button type="button" class="btn btn-primary" onclick="changeSchParti()">확인</button>
													</div>
												</div>
											</div>
										</div>
									</form>
									<!-- 모달 끝 -->
							</div>
							<!-- 장소 -->
							<div>
								<th:block th:if="${allPost.schPlace != null}" th:text="'장소 : ' + ${allPost.schPlace}"></th:block>
							</div>
							<th:block th:text="${allPost.schContent}">
								<!-- 내용이 여기에 들어갑니다. -->
							</th:block>
							<!-- 참석 여부 버튼 -->
							<th:block th:each="rparti : ${readSchparti}" th:if="${rparti.schNo == allPost.schNo and #dates.format(allPost.schEndTime) >= #dates.format(#calendars.createNow())}">
								<div th:attr="data-feed-sch-type=${rparti.partiCheck}" style="text-align: center;">
									<button type="button" class="btn"
										th:classappend="${rparti.partiCheck == 'Y' ? 'btn-success' : 'btn-outline-success'}"
										data-sch-type-status="Y" onclick="toggleFeedSchButtonStyle(this)">참석</button>
									<button type="button" class="btn"
										th:classappend="${rparti.partiCheck == 'N' ? 'btn-danger' : 'btn-outline-danger'}"
										data-sch-type-status="N" onclick="toggleFeedSchButtonStyle(this)">불참</button>
									<button type="button" class="btn"
										th:classappend="${rparti.partiCheck == 'A' ? 'btn-secondary' : 'btn-outline-secondary'}"
										data-sch-type-status="A" onclick="toggleFeedSchButtonStyle(this)">미정</button>
								</div>
							</th:block>
							<div class="card-footer">
								<!-- 북마크, 댓글수 -->
								<div>
								
								</div>
								<div class="row">
									<div class="col-md-8">
										<!--/* <h6 th:text="'댓글('+${#lists.size(projectWritingDetaisComment)}+')'"></h6> */-->
										<h6 th:text="댓글"></h6>
										<ul class="list-unstyled">
											<li th:each="com : ${projectWritingDetaisComment}" th:data-post-code="${com.comNo}"
												th:if="${allPost.proPostNo == com.proPostNo}">
												<span th:utext="${com.profileImg}"></span>
												<span th:text="${com.name}"></span>
												<span th:text="${com.comDate}"></span>
												<span th:text="${com.comContent}"></span>
												<th:block th:if="${com.id == session.Id}">
													<span onclick="UpdateWritingComment()" class="spanCursor" style="color: red">수정</span>
													<span></span>
													<span onclick="deleteWritingComment()" class="spanCursor">X</span>
												</th:block>
											</li>
										</ul>
									</div>
									<div class="col-md-4">
										<div class="form-group">
											<input type="text" class="form-control" placeholder="댓글 작성">
										</div>
										<button type="button" class="btn btn-primary" onclick="createCommentButton()"
												th:data-post-writing-no="${allPost.proPostNo}">댓글 등록</button>
									</div>
								</div>
							</div>
						</div>
					</div>
					<!-- 3종료 -->
				</th:block>


				<!-- 4.할 일 -->
				<th:block th:if="${allPost.postType == '4'}">
					<div class="card" style="margin-bottom: 15px; background-color: #fff;"
						 th:data-feed-post-todo-no="${allPost.proPostNo}">
						<!-- 프로필 이미지, 이름, 작성 날짜 및 시간, 상단고정 표시, 수정, 삭제 -->
						<div>
					        <span th:text="${allPost.profileImg}"></span>
					        <span th:text="${allPost.name}"></span>
					        <span th:text="${allPost.postDate}"></span>
					    </div>
						<div class="card-header" th:text="'할 일 : ' + ${allPost.postTitle}">
							<!-- 글 제목 -->
						</div>
						<div class="card-body">
							<!-- 진척도 바 -->
							<div>
								<div class="progress">
									<th:block th:each="prog : ${readAllTodoListPer}" th:if="${prog.proPostNo == allPost.proPostNo}">
										<div class="progress-bar bg-info" role="progressbar" th:style="'width: ' + ${prog.per} + '%'" aria-valuemin="0" aria-valuemax="100"></div>
									<th:block>
								</div>
							</div>
							<!-- 할 일 체크 공간 -->
							<div>
								<ul class="list-group">
								  <li class="list-group-item" th:each="rt : ${readTodoList}" th:if="${rt.proPostNo == allPost.proPostNo}">
								    <input class="form-check-input me-1" type="checkbox"
								    	   th:data-todo-no="${rt.todoNo}"
								    	   th:checked="${rt.todoCheck == 'Y'}" style="cursor: pointer;"
										   th:onclick="changeTodoStatus()">
								    	   <!-- th:value="${rt.todoNo}" th:id="'firstCheckboxStretched' + ${rt.todoNo}" -->
								   	<span th:text="${rt.todoContent}"></span>
										<span th:text="${#dates.format(rt.todoEnd, 'MM/dd')}"  th:style="${rt.todoEnd >= #dates.format(currentTime, 'MM/dd') ? 'color: red' : ''}"></span>
										<span th:text="'담당자' + ${rt.name}"></span>
								  </li>
								</ul>
							</div>
							<div class="card-footer">
								
								<!-- 북마크, 댓글수 -->
								<div class="row">
									<div class="col-md-8">
										<!--/* <h6 th:text="'댓글('+${#lists.size(projectWritingDetaisComment)}+')'"></h6> */-->
										<h6 th:text="댓글"></h6>
										<ul class="list-unstyled">
											<li th:each="com : ${projectWritingDetaisComment}" th:data-post-code="${com.comNo}"
												th:if="${allPost.proPostNo == com.proPostNo}">
												<span th:utext="${com.profileImg}"></span>
												<span th:text="${com.name}"></span>
												<span th:text="${com.comDate}"></span>
												<span th:text="${com.comContent}"></span>
												<th:block th:if="${com.id == session.Id}">
													<span onclick="UpdateWritingComment()" class="spanCursor" style="color: red">수정</span>
													<span></span>
													<span onclick="deleteWritingComment()" class="spanCursor">X</span>
												</th:block>
											</li>
										</ul>
									</div>
									<div class="col-md-4">
										<div class="form-group">
											<input type="text" class="form-control" placeholder="댓글 작성">
										</div>
										<button type="button" class="btn btn-primary" onclick="createCommentButton()"
												th:data-post-writing-no="${allPost.proPostNo}">댓글 등록</button>
									</div>
								</div>
							</div>
						</div>
					</div>
					<!-- 4종료 -->
				</th:block>
				
				<!-- 5.투표 -->
				<th:block th:if="${allPost.postType == '5'}">
					<div class="card" style="margin-bottom: 15px; background-color: #fff;"
						 th:data-feed-post-vote-no="${allPost.voteNo}">
						<!-- 프로필 이미지, 이름, 작성 날짜 및 시간, 상단고정 표시, 수정, 삭제 -->
						<div>
					        <span th:text="${allPost.profileImg}"></span>
					        <span th:text="${allPost.name}"></span>
					        <span th:text="${allPost.postDate}"></span>
					    </div>
					    <div>
						    <th:block th:if="${#dates.format(allPost.voteEndDay) >= #dates.format(#calendars.createNow())} and ${allPost.voteEndCheck == 'N'}">
						        <button type="button" class="btn btn-outline-danger">진행중</button>
						    </th:block>
						    <th:block th:if="${#dates.format(allPost.voteEndDay) < #dates.format(#calendars.createNow())}">
						        <button type="button" class="btn btn-outline-secondary">투표 종료</button>
						    </th:block>
					    </div>
					    	<div class="card-header" th:text="'투표 : ' + ${allPost.postTitle} + ' 투표 마감일 ' + ${#dates.format(allPost.voteEndDay, 'yyyy-MM-dd')} + '까지'">
					    
								<!-- 글 제목 -->
							</div>
						<div class="card-body">
							<!-- 투표 설명 -->
							<div th:text="'투표 설명 : ' + ${allPost.voteContent}"></div>
							
							<!-- 투표창 -->
							<ul class="list-group">
							  <li class="list-group-item" th:each="vtCheck : ${readVoteListCheck}" th:if="${vtCheck.voteNo == allPost.voteNo}">
							  	<span th:utext="${vtCheck.voteDetailImg}" th:data-vote-detail-img="${vtCheck.voteDetailImg}"></span>
							    <input class="form-check-input me-1" type="checkbox"
							    	   th:data-vote-detail-no="${vtCheck.voteDetailNo}"
							    	   th:text="${vtCheck.voteDetailContent}"
									   th:onclick="changeTodoStatus()">
							    	   <!-- th:checked="${rt.todoCheck == 'Y'}" style="cursor: pointer;" -->
							    	   <!-- th:data-vote-detail-no="${vote.voteDetailNo}" -->
							  </li>
							</ul>
							
							<!-- 하단 -->
							<div class="card-footer">
								
								<!-- 북마크, 댓글수 -->
								<div class="row">
									<div class="col-md-8">
										<h6 th:text="댓글"></h6>
										<ul class="list-unstyled">
											<li th:each="com : ${projectWritingDetaisComment}" th:data-post-code="${com.comNo}"
												th:if="${allPost.proPostNo == com.proPostNo}">
												<span th:utext="${com.profileImg}"></span>
												<span th:text="${com.name}"></span>
												<span th:text="${com.comDate}"></span>
												<span th:text="${com.comContent}"></span>
												<th:block th:if="${com.id == session.Id}">
													<span onclick="UpdateWritingComment()" class="spanCursor" style="color: red">수정</span>
													<span></span>
													<span onclick="deleteWritingComment()" class="spanCursor">X</span>
												</th:block>
											</li>
										</ul>
									</div>
									<div class="col-md-4">
										<div class="form-group">
											<input type="text" class="form-control" placeholder="댓글 작성">
										</div>
										<button type="button" class="btn btn-primary" onclick="createCommentButton()"
												th:data-post-writing-no="${allPost.proPostNo}">댓글 등록</button>
									</div>
								</div>
							</div>
						</div>
					</div>
					<!-- 5종료 -->
				</th:block>
				
				
				

				<!-- 포스트 종료 -->
			</th:block>
		</div>
			</div>
		</div>
		<!-- 참여자공간 -->
		<div>
			<th:block th:text="${session.Id}"></th:block>
			<div class="card" style="width: 18rem;">
			  <div class="card-header" th:each="pUser : ${projectPartiMember}"
			  	   th:text="'프로젝트 관리자 : ' + ${pUser.profileImg} + ${pUser.name}"
			  	   th:if="${pUser.id == readProAuth.id}"
			  	   th:data-user-id="${pUser.id}">
			  	   <span th:if="${session.Id == pUser.id}" th:text="(나)"></span>
			  </div>
			  <ul class="list-group list-group-flush">
			    <li class="list-group-item" th:each="pUser : ${projectPartiMember}"
			    	th:if="${pUser.id != readProAuth.id}"
			    	th:text="${pUser.profileImg} + ${pUser.name}"
			    	th:data-user-id="${pUser.id}">
			    	<span th:if="${session.Id == pUser.id}" th:text="(나)"></span>
			    	</li>
			  </ul>
			</div>
			<!-- <div class="container float-start" style="width: 250px;">
				<div class="row">
					<div class="col-md-3">
						왼쪽 사이드바 영역
						<div class="sidebar">
							<ul class="list-unstyled">
								<li>
									이미지
									<img src="" alt="이미지" class="img-fluid">
								</li>
							</ul>
						</div>
					</div>
					<div class="col-md-9">
						오른쪽 콘텐츠 영역
						<div class="content">
							<ul class="list-unstyled">
								<li>
									이름
									<h4>사용자 이름</h4>
									<th:block th:text="${#calendars.format(#calendars.createNow(), 'yyyy-MM-dd HH:mm')}"></th:block>
								</li>
								<li>
									메시지 아이콘
									<i class="fas fa-envelope"></i>
								</li>
							</ul>
						</div>
					</div>
				</div>
			</div> -->


		</div>
	</div>
	<div>
		<!-- 글 조회 공간 -->
		<div></div>
	</div>
	
	
	
	
	
	<!-- 버튼 상태 변경(업무상태, 작성 모달창) -->	
	<script>
		let selectedButton = workTypeButtonToggle;

		function toggleButtonStyle(button) {
			
		  if (selectedButton !== button) {
		    if (selectedButton) {
					console.log('selectedButton찾기',selectedButton);
		      resetButtonStyle(selectedButton);
		    }
		    
		    let className = button.classList.item(1);
		
		    if (className.startsWith('btn-outline')) {
		      let filledClassName = className.replace('btn-outline', 'btn');
		      button.classList.remove(className);
		      button.classList.add(filledClassName);
		    } else {
		      let outlineClassName = className.replace('btn', 'btn-outline');
		      button.classList.remove(className);
		      button.classList.add(outlineClassName);
		    }
		
		    selectedButton = button;
		  } else {
				//버튼 초기화
		    // resetButtonStyle(button);
		    // selectedButton = null;
		  }
		}
		
		//버튼 초기화
		function resetButtonStyle(button) {
		  let className = button.classList.item(1);
		  //console.log(className);
		  if (className.startsWith('btn-outline')) {
		    let outlineClassName = className.replace('btn-outline', 'btn');
		    button.classList.remove(className);
		    button.classList.add(outlineClassName);
		  } else {
		    let filledClassName = className.replace('btn', 'btn-outline');
		    button.classList.remove(className);
		    button.classList.add(filledClassName);
		  }
		}
		
	</script>

	<!-- 버튼 상태 변경(업무 상태, 게시물 조회) -->
	<script>
		let selectedFeedButton = new Map();

		function toggleFeedButtonStyle(button) {
			let postWorkNo = button.closest('.card').dataset.feedPostNo;// 글 번호
			let workNo = button.closest('.card').dataset.feedWorkNo;
			//let newStatus = button.parentNode.dataset.feedWorkType;//신규 선택 버튼 번호
			let newStatus = button.dataset.workTypeStatus;
			let oldStatusNo = selectedFeedButton.get(postWorkNo);//선택했던 기존 버튼 번호 null or 존재

			//기존 상태 버튼 찾기
			let oldButton;
			if(oldStatusNo == null) {//선택했던 기존 버튼이 없다면
				let firstButtonStatusNo = button.parentNode.dataset.feedWorkType;//최초 버튼 찾기
				oldButton = button.closest(".card").querySelector('[data-work-type-status="' + firstButtonStatusNo + '" ]');//최초 버튼 상태 찾기
			} else {//선택했던 기존 버튼이 있다면
				oldButton = button.closest(".card").querySelector('[data-work-type-status="' + oldStatusNo + '" ]');//구 버튼 상태를 찾기
			}

			selectedFeedButton.set(postWorkNo, newStatus);//신규 번호 삽입
			
			console.log('신규번호?',newStatus);//새 번호 찾기
			//console.log('기존번호?',oldStatusNo);//새 번호 찾기
			console.log('업무번호',workNo);
			//console.log(oldButton);
			//console.log(button);
			
			fetch("/updateWorkPostStatus", {
						method: 'PUT',
						headers: {
							'Content-Type': 'application/json'
						},
						body: JSON.stringify({
							'workStatus' : newStatus,
			   				'workNo': workNo
			   			})
					})
					.then(response => response.json())
					.then(res => {
						console.log(res);
						if(res.result == '성공') {
							
							  if (oldButton !== button) {//기존 버튼과 셀렉한 버튼이 다를 때
							    if (oldButton) {
							      resetButtonStyle(oldButton);
							    }
							    
							    let className = button.classList.item(1);
							
							    if (className.startsWith('btn-outline')) {
							      let filledClassName = className.replace('btn-outline', 'btn');
							      button.classList.remove(className);
							      button.classList.add(filledClassName);
							    } else {
							      let outlineClassName = className.replace('btn', 'btn-outline');
							      button.classList.remove(className);
							      button.classList.add(outlineClassName);
							    }
							
							    oldButton = button;
							  }
							  
							  //차트 재호출
							  google.charts.setOnLoadCallback(drawChart);
							  
						} else {
							alert('상태 수정 실패');
						}
					});
			
		}
		
		//버튼 초기화
		function resetButtonStyle(button) {
		  let className = button.classList.item(1);
		  //console.log(className);
		  if (className.startsWith('btn-outline')) {
		    let outlineClassName = className.replace('btn-outline', 'btn');
		    button.classList.remove(className);
		    button.classList.add(outlineClassName);
		  } else {
		    let filledClassName = className.replace('btn', 'btn-outline');
		    button.classList.remove(className);
		    button.classList.add(filledClassName);
		  }
		}
		
	</script>
	
	<!-- 버튼 상태(일정) 참가 상황 -->
	<script>
		let selectedSchButton = new Map();

		function toggleFeedSchButtonStyle(button) {
			let postSchNo = button.closest('.card').dataset.feedPostSchNo;// 글 번호(map용)
			let schNo = button.closest('.card').dataset.feedSchNo;//sch 고유번호, update용
			let newStatus = button.dataset.schTypeStatus;//선택한 번호
			let oldSchStatusNo = selectedSchButton.get(postSchNo);//선택했던 기존 버튼 번호 null or 존재

			//기존 상태 버튼 찾기
			let oldSchButton;
			if(oldSchStatusNo == null) {//선택했던 기존 버튼이 없다면
				let firstButtonSchStatusNo = button.parentNode.dataset.feedSchType;//최초 버튼 찾기
				oldSchButton = button.closest(".card").querySelector('[data-sch-type-status="' + firstButtonSchStatusNo + '" ]');//최초 버튼 상태 찾기
			} else {//선택했던 기존 버튼이 있다면
				oldSchButton = button.closest(".card").querySelector('[data-sch-type-status="' + oldSchStatusNo + '" ]');//구 버튼 상태를 찾기
			}

			selectedSchButton.set(postSchNo, newStatus);//신규 번호 삽입
			
			//console.log('신규상태',newStatus);//새 번호 찾기
			//console.log('고유번호',schNo);
			
			fetch("/updateSchPartiCheck", {
				method: 'PUT',
				headers: {
					'Content-Type': 'application/json'
				},
				body: JSON.stringify({
					'partiCheck' : newStatus,
	   				'schNo': schNo
	   			})
			})
			.then(response => response.json())
			.then(res => {
				console.log(res);
				if(res.result == '성공') {
					
					if (oldSchButton !== button) {//기존 버튼과 셀렉한 버튼이 다를 때
						if (oldSchButton) {
							resetButtonStyle(oldSchButton);
						}
						
						let className = button.classList.item(1);
				
						if (className.startsWith('btn-outline')) {
							let filledClassName = className.replace('btn-outline', 'btn');
							button.classList.remove(className);
							button.classList.add(filledClassName);
						} else {
							let outlineClassName = className.replace('btn', 'btn-outline');
							button.classList.remove(className);
							button.classList.add(outlineClassName);
						}
				
						oldSchButton = button;
					}
					/* else {//버튼취소하는기능
						resetButtonStyle(button);
						selectedSchButton.set(postSchNo, null);
						newStatus = 'B';
					} */
					
					changeSchStatus(button, newStatus);
					
				} else {
					alert('상태 수정 실패');
				}
			});
			
		}
		
		//버튼 초기화
		function resetButtonStyle(button) {
		  let className = button.classList.item(1);
		  //console.log(className);
		  if (className.startsWith('btn-outline')) {
		    let outlineClassName = className.replace('btn-outline', 'btn');
		    button.classList.remove(className);
		    button.classList.add(outlineClassName);
		  } else {
		    let filledClassName = className.replace('btn', 'btn-outline');
		    button.classList.remove(className);
		    button.classList.add(filledClassName);
		  }
		}
		
		//글자 바꾸기
		function changeSchStatus(button, newStatus) {
			let schPartiChange = button.closest(".card").querySelector('[data-sch-user-id]').nextElementSibling;//상태창 위치
			console.log('ss',button.closest(".card").querySelector('[data-sch-user-id]'))
			console.log('sss',schPartiChange);
			
			if(newStatus == 'Y') {
				schPartiChange.textContent ='참석';
				button.closest(".card").querySelector('[data-sch-list-parti-id = '+selfId+']').dataset.schStatus = 'Y';
				schPartiChange.style.color = 'green';
			} else if(newStatus == 'N') {
				schPartiChange.textContent ='불참';
				button.closest(".card").querySelector('[data-sch-list-parti-id = '+selfId+']').dataset.schStatus = 'N';
				schPartiChange.style.color = 'red';
			} else if(newStatus == 'A') {
				schPartiChange.textContent ='미정';
				button.closest(".card").querySelector('[data-sch-list-parti-id = '+selfId+']').dataset.schStatus = 'A';
				schPartiChange.style.color = 'gray';
			}
		}
	</script>



	<!-- 글 작성 -->
	<script>
		
		createWritingButton.addEventListener('click', function () {
			//제목 빈값 검사
			let titles = document.getElementsByClassName('postTitle');
			if(titles[0].value == '') {
				titles[0].focus();
				alert('제목을 입력하세요');
				return;
			}
			
			//내용 빈값 검사
			if(writingContent.value == '') {
				alert('내용을 입력하세요');
				writingContent.focus();
				return;
			}
			
			//프로젝트 넘버 찾기(주소)
			let url = window.location.pathname;
			let lastIndex = url.lastIndexOf('/');
			let projectNo = url.substring(lastIndex + 1);
			
			fetch("/postCreateWriting", {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json'
				},
				body: JSON.stringify({
	   				'postTitle': titles[0].value,
	   				'writingContent': writingContent.value,
	   				'proNo': projectNo
	   			})
			})
			.then(response => response.json())
			.then(res => location.href="/proPostMain/" + projectNo + "?homeTab=2");
			
		});

	</script>
	
	<!-- 업무 작성 -->
	<script>
		//담당자 값 가져오기
		let workPersonArr = [];
		function workPostPeople(e) {
			workPersonArr = [];
	
			for(let i=0; i < e.options.length; i++) {
				let option = e.options[i];
				if(option.selected) {
					workPersonArr.push(option.value);
				}
			};
			
			return workPersonArr;
		}
		
		//등록 버튼 클릭
		createWorkButton.addEventListener('click', function () {
			//제목 빈값 검사
			let titles = document.getElementsByClassName('postTitle');
			if(titles[1].value == '') {
				titles[1].focus();
				alert('제목을 입력하세요');
				return;
			}
			
			//내용 빈값 검사
			if(workWritingContent.value == '') {
				alert('내용을 입력하세요');
				workWritingContent.focus();
				return;
			}
			
			//프로젝트 넘버 찾기(주소)
			let url = window.location.pathname;
			let lastIndex = url.lastIndexOf('/');
			let projectNo = url.substring(lastIndex + 1);
			
			// console.log(titles[1].value);
			// console.log('업무그룹',workPostGroup.value);
			// console.log('업무상태',selectedButton.dataset.workTypeStatus);
			// console.log('우선순위',workPostPri.value);
			// console.log(startWorkDate.value);
			// console.log(endWorkDate.value);
			// console.log('내용',workWritingContent.value);
			// console.log('참여자', workPersonArr);
			fetch("/postCreateWork", {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json'
				},
				body: JSON.stringify({
	   				'proNo': projectNo,
	   				'postTitle': titles[1].value,
	   				'workGroupNo': workPostGroup.value,
	   				'workStatus': selectedButton.dataset.workTypeStatus,
	   				'workPri': workPostPri.value,
	   				'workStartDay': startWorkDate.value,
	   				'workStartTime': startWorkDate.value,
	   				'workEndDay': endWorkDate.value,
	   				'workEndTime': endWorkDate.value,
	   				'workContent': workWritingContent.value,
	   				'workPersonArr': workPersonArr
	   			})
			})
			.then(response => response.json())
			//.then(res => location.href="/proPostMain/" + projectNo + "?homeTab=2");
			
		});
	</script>
	
	<!-- 댓글 등록 -->
	<script>
		function createCommentButton() {
			let targetButton = event.target;//버튼 동적 확인
			let com = targetButton.parentNode.children[0].children[0]; //텍스트값 찾기
			if(com.value == '') {
				com.focus();
				alert('댓글을 입력하세요');
				return;
			}
			
			let writingNo = targetButton.dataset.postWritingNo;//글번호 찾기
			
			let url = window.location.pathname;
			let lastIndex = url.lastIndexOf('/');
			let projectNo = url.substring(lastIndex + 1);
			
			fetch("/postCreateComment", {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json'
				},
				body: JSON.stringify({
	   				'proPostNo': writingNo,
	   				'comContent': com.value
	   			})
			})
			.then(response => response.json())
			.then(res => {
				console.log(res)
				let insertComment = targetButton.closest('.card').getElementsByClassName('list-unstyled')[0];
				console.log('여기',insertComment)
				
				insertComment.insertAdjacentHTML('beforeend', 
					'<li data-post-code="' + res.result + '">'+
						'<span></span>'+
						'<span>' + selfName + '</span>'+
						'<span>' + currentTime + '</span>'+
						'<span>' + com.value + '</span>'+
						'<span onclick="UpdateWritingComment()" class="spanCursor" style="color: red">수정</span>'+
						'<span></span>'+
						'<span onclick="deleteWritingComment()" class="spanCursor">X</span>'+
					'</li>'
				);
				com.focus();
				com.value = '';
				//location.href="/proPostMain/" + projectNo + "?homeTab=2"
			});
		}
		
		//현재시간 구하기
		const currentTime = formatDate();
		
		function formatDate() {
		  let date = new Date();
		  const year = date.getFullYear();
		  const month = String(date.getMonth() + 1).padStart(2, '0');
		  const day = String(date.getDate()).padStart(2, '0');
		  const hours = String(date.getHours()).padStart(2, '0');
		  const minutes = String(date.getMinutes()).padStart(2, '0');
		  
		  return `${year}/${month}/${day} ${hours}:${minutes}`;
		}
	</script>
	
	<!-- 댓글 삭제  -->
	<script>
		function deleteWritingComment() {
			let targetButton = event.target;
			//console.log(targetButton.parentNode.dataset.postCode);
			
			let url = window.location.pathname;
			let lastIndex = url.lastIndexOf('/');
			let projectNo = url.substring(lastIndex + 1);
			
			fetch("/postDeleteComment", {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json'
				},
				body: JSON.stringify({
	   				'comNo': targetButton.parentNode.dataset.postCode
	   			})
			})
			.then(response => response.json())
			.then(res => {
				targetButton.parentNode.remove()
			});
		}
	</script>
	
	<!-- 댓글 수정  -->
	<script>
		function UpdateWritingComment() {
			let targetButton = event.target;
			let comNo = targetButton.parentNode.dataset.postCode;//댓글 번호
			
			let oldCom = targetButton.parentNode.children[3].textContent;//기존 댓글
			let oldDate = targetButton.parentNode.children[2].textContent;//기존 날짜, 후에 수정x, 다시 불러 오는 용도
			
			//초기화
			targetButton.parentNode.children[2].textContent = '';//날짜 초기화
			targetButton.parentNode.children[3].textContent = '';//댓글 초기화
			targetButton.parentNode.children[4].textContent = '';//수정 초기화
			targetButton.parentNode.children[6].textContent = '';//X 초기화
			
			if(document.getElementById('newComment') != null) {
				let nC = document.getElementById('newComment').parentNode.parentNode;
				nC.childNodes[5].textContent = document.getElementById('newComment').dataset.comDate;
				nC.childNodes[7].textContent = document.getElementById('newComment').value;
				nC.childNodes[9].textContent = '수정';
				nC.childNodes[11].textContent = '';
				nC.childNodes[13].textContent = 'X';
			}
			
			// 댓글 수정 폼 생성
			targetButton.parentNode.children[5].innerHTML = 
					'<input type="text" data-com-date="' + oldDate + '" placeholder="댓글 수정" id="newComment" value="' + oldCom + '">'
					+'<span id="ooo" class="spanCursor">수정</span>'
					+'<span id="xxx" class="spanCursor">취소</span>';
					
			// 취소버튼
			document.getElementById('xxx').addEventListener('click', function() {
				targetButton.parentNode.children[2].textContent = oldDate;
				targetButton.parentNode.children[3].textContent = oldCom;
				targetButton.parentNode.children[4].textContent = '수정';
				targetButton.parentNode.children[5].textContent = '';
				targetButton.parentNode.children[6].textContent = 'X';
			});
			
			// 수정버튼
			document.getElementById('ooo').addEventListener('click', function() {
				let newCom = document.getElementById('newComment');
				if(newCom.value == '') {
					newCom.focus();
					alert('댓글을 수정하세요');
				} else {
					
					fetch("/postUpdateComment", {
						method: 'PUT',
						headers: {
							'Content-Type': 'application/json'
						},
						body: JSON.stringify({
							'comContent' : newCom.value,
			   				'comNo': comNo
			   			})
					})
					.then(response => response.json())
					.then(res => {
						
						if(res.result == '성공') {
							targetButton.parentNode.children[2].textContent = oldDate;
							targetButton.parentNode.children[3].textContent = newCom.value;
							targetButton.parentNode.children[4].textContent = '수정';
							targetButton.parentNode.children[6].textContent = 'X';
							targetButton.parentNode.children[5].textContent = '';
							
							let url = window.location.pathname;
							let lastIndex = url.lastIndexOf('/');
							let projectNo = url.substring(lastIndex + 1);
							
						} else {
							alert('댓글 수정 실패');
						}
					});
				}
			});
			
		}
		
	</script>
	
	<!-- 참석자 선택 처리 -->
	<script>
		function changeSchParti() {
			let inputValues = event.target.closest('.modal-content').children[1].children[0].querySelectorAll('input[type="checkbox"]:checked');
			let formData = new FormData();
			let formDataDel = new FormData();
			let updatePartiList = [];
			let updateObj = {};
			
			let schPlNo = event.target.closest('.card').dataset.feedSchNo;//스케줄 고유번호
			
			inputValues.forEach(inputValue => {
				updateObj.schNo = schPlNo;
				updateObj.partiCheck = inputValue.dataset.schStatus == null ? 'A' : inputValue.dataset.schStatus;
				updateObj.id = inputValue.dataset.schListId;
				updatePartiList.push(updateObj);
				updateObj = {};
		    });
			let noSchNo = [{'schNo' : schPlNo}];
			formData = updatePartiList.length == 0 ? noSchNo : updatePartiList;
			console.log(formData);
			
			//console.log(formDataDel.get('schNo'))
					
			//기존 & 추가 인원 추가
			fetch("/insertPartiMemberAll", {
				method: 'POST',
				headers : {
					'Content-Type': 'application/json'
				},
				body : JSON.stringify(formData)
			})
			.then(response => response.json())
			.then(res => {
				let rC = res.result;
				
				if(rC == -1) {
					console.log('0명');
					const currentURL = window.location.href;
					window.location.href = currentURL;
				} else if (rC >= 1) {
					console.log(rC + '명 업데이트');
					const currentURL = window.location.href;
					window.location.href = currentURL;
				}else {
					alert('알 수 없는 접근')
				}
			});
			
		}
	</script>
	<!-- 시간 단위 조정 -->
	<!-- <script>
		// 10분 간격으로 선택할 수 있도록 설정
		var startDateInput = document.getElementById('startDate');
		startDateInput.addEventListener('input', function() {
		  // 현재 선택된 날짜와 시간을 가져옴
		  var selectedDate = new Date(startDateInput.value);
		  // 분 단위를 가져옴
		  var minutes = selectedDate.getMinutes();
		  
		  // 분 단위를 10분 간격으로 반올림
		  var roundedMinutes = Math.round(minutes / 10) * 10;
		  
		  // 선택된 날짜와 시간을 조정하여 10분 간격으로 설정
		  selectedDate.setMinutes(roundedMinutes);
		  
		  // 조정된 값을 다시 입력 요소에 설정
		  startDateInput.value = selectedDate.toISOString().slice(0, 16);
		});
	</script> -->
	
	<!-- todo 버튼 상태 변경 -->
	<script>
		function changeTodoStatus() {
			let todoNo = event.target.dataset.todoNo;
			let checkedYN = event.target.checked ? 'Y' : 'N';
			let totalInputExp = event.target.parentNode.parentNode;
			
			fetch("/updateTotoStatus", {
				method: 'PUT',
				headers: {
					'Content-Type': 'application/json'
				},
				body: JSON.stringify({
					'todoNo' : todoNo,
	   				'todoCheck': checkedYN
	   			})
			})
			.then(response => response.json())
			.then(res => {
				let totalInput = totalInputExp.querySelectorAll('input').length;//총 input 수
				let countInput = 0;
				let inputs = totalInputExp.querySelectorAll('input');
				inputs.forEach(input => {
					input.checked ? countInput++ : 0;
				});
				let per = countInput / totalInput * 100;
				//console.log(per)
				
				//퍼센트 변경
				totalInputExp.closest('.card-body').children[0].children[0].children[0].style.width = per + '%';
				
			})
			.catch(error => {
				console.error('Error: ',error);
			});
			
		}
	</script>

	
<!-- id값 가져오기 -->
<script type="text/javascript" th:inline="javascript">
	/*<![CDATA[*/
		
		let selfId = /*[[${session.Id}]]*/;
		let selfName = /*[[${session.Name}]]*/;
	/*]]>*/
</script>
	<!-- <script src="../proPost/proPostJs/proPostDetail.js"></script> -->
</body>
</html>